name: CI

on: [pull_request, push]

jobs:
  windows-32:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 5.0.100-preview.8.20417.9
      - uses: actions/setup-java@v1
        with:
          java-version: 11
      - name: Build Installer
        uses: eskatos/gradle-command-action@v1
        with:
          gradle-version: 6.0.1
          arguments: generateInstallers -PXmx3072m -Pwindows32 -DsystemProp.org.gradle.internal.http.connectionTimeout=180000 -DsystemProp.org.gradle.internal.http.socketTimeout=180000 -PjenkinsBuild
      - name: Archive Artifacts
        uses: actions/upload-artifact@v2
        with:
          name: win32-installer
          path: build\outputs\
  windows-64:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 5.0.100-preview.8.20417.9
      - uses: actions/setup-java@v1
        with:
          java-version: 11
      - name: Build Installer
        uses: eskatos/gradle-command-action@v1
        with:
          gradle-version: 6.0.1
          arguments: generateInstallers -PXmx3072m -DsystemProp.org.gradle.internal.http.connectionTimeout=180000 -DsystemProp.org.gradle.internal.http.socketTimeout=180000 -PjenkinsBuild
      - name: Archive Artifacts
        uses: actions/upload-artifact@v2
        with:
          name: win64-installer
          path: build\outputs\
  linux:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 5.0.100-preview.8.20417.9
      - uses: actions/setup-java@v1
        with:
          java-version: 11
      - name: Build Installer
        uses: eskatos/gradle-command-action@v1
        with:
          gradle-version: 6.0.1
          arguments: generateInstallers -PXmx3072m -PlinuxBuild -DsystemProp.org.gradle.internal.http.connectionTimeout=180000 -DsystemProp.org.gradle.internal.http.socketTimeout=180000 -PjenkinsBuild
      - name: Archive Artifacts
        uses: actions/upload-artifact@v2
        with:
          name: linux-installer
          path: build\outputs\
  macos:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 5.0.100-preview.8.20417.9
      - uses: actions/setup-java@v1
        with:
          java-version: 11
      - name: Build Installer
        uses: eskatos/gradle-command-action@v1
        with:
          gradle-version: 6.0.1
          arguments: generateInstallers -PXmx3072m -PmacBuild -DsystemProp.org.gradle.internal.http.connectionTimeout=180000 -DsystemProp.org.gradle.internal.http.socketTimeout=180000 -PjenkinsBuild
      - name: Archive Artifacts
        uses: actions/upload-artifact@v2
        with:
          name: macos-installer
          path: build\outputs\
